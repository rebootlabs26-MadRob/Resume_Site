 "DOCKER_INFLUXDB_INIT_USERNAME=admin",
                "DOCKER_INFLUXDB_INIT_PASSWORD=rebootlabs",


[mastersurface@RBL-SurfaceHub:~]$ docker inspect influxdb --format='{{json .Mounts}}' | python3 -m json.tool
[
    {
        "Type": "volume",
        "Name": "2a454e5f08c847e180551c40467dc8ee2469a3697436f149ec1685365583e0e1",
        "Source": "/var/snap/docker/common/var-lib-docker/volumes/2a454e5f08c847e180551c40467dc8ee2469a3697436f149ec1685365583e0e1/_data",
        "Destination": "/etc/influxdb2",
        "Driver": "local",
        "Mode": "",
        "RW": true,
        "Propagation": ""
    },
    {
        "Type": "volume",
        "Name": "influxdb-data",
        "Source": "/var/snap/docker/common/var-lib-docker/volumes/influxdb-data/_data",
        "Destination": "/var/lib/influxdb2",
        "Driver": "local",
        "Mode": "z",
        "RW": true,
        "Propagation": ""
    }
]
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ docker inspect telegraf --format='{{json .Mounts}}' | python3 -m json.tool
[
    {
        "Type": "bind",
        "Source": "/home/mastersurface/telegraf/telegraf.conf",
        "Destination": "/etc/telegraf/telegraf.conf",
        "Mode": "ro",
        "RW": false,
        "Propagation": "rprivate"
    }
]
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ docker inspect mosquitto --format='{{json .Mounts}}' | python3 -m json.tool
[
    {
        "Type": "bind",
        "Source": "/home/mastersurface/mosquitto/config/mosquitto.conf",
        "Destination": "/mosquitto/config/mosquitto.conf",
        "Mode": "",
        "RW": true,
        "Propagation": "rprivate"
    },
    {
        "Type": "volume",
        "Name": "f583f0a1f6543136a584498555a5ff452ff3d4dc1f546937c5709877ea8fd23b",
        "Source": "/var/snap/docker/common/var-lib-docker/volumes/f583f0a1f6543136a584498555a5ff452ff3d4dc1f546937c5709877ea8fd23b/_data",
        "Destination": "/mosquitto/data",
        "Driver": "local",
        "Mode": "",
        "RW": true,
        "Propagation": ""
    },
    {
        "Type": "volume",
        "Name": "3a5770e897b9430448c77a56c3af337b5fb3f25b026a3c4cfc8cb678b15a5660",
        "Source": "/var/snap/docker/common/var-lib-docker/volumes/3a5770e897b9430448c77a56c3af337b5fb3f25b026a3c4cfc8cb678b15a5660/_data",
        "Destination": "/mosquitto/log",
        "Driver": "local",
        "Mode": "",
        "RW": true,
        "Propagation": ""
    }
]
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ docker inspect grafana --format='{{json .Mounts}}' | python3 -m json.tool
[]
[mastersurface@RBL-SurfaceHub:~]$






[mastersurface@RBL-SurfaceHub:~]$ cat /home/mastersurface/telegraf/telegraf.conf
[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  flush_interval = "10s"

[[outputs.influxdb_v2]]
  urls = ["http://172.17.0.1:8086"]
  token = "RBL_SuperToken_2024"
  organization = "RBL_SPHub"
  bucket = "Mad_Masters/Helpers"

[[inputs.mqtt_consumer]]
  servers = ["tcp://172.17.0.1:1883"]
  topics = ["rbl/+/+"]
  qos = 0
  client_id = "telegraf-hub"
  data_format = "json"
  topic_tag = "topic"
  json_string_fields = ["status"]
[mastersurface@RBL-SurfaceHub:~]$



[mastersurface@RBL-SurfaceHub:~]$ cat /home/mastersurface/mosquitto/config/mosquitto.conf
listener 1883
allow_anonymous true
[mastersurface@RBL-SurfaceHub:~]$



[mastersurface@RBL-SurfaceHub:~]$ ls -la /home/mastersurface/telegraf/
total 12
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 18 10:15 .
drwxr-x--- 30 mastersurface mastersurface 4096 Dec 25 18:18 ..
-rw-rw-r--  1 mastersurface mastersurface  493 Dec 18 10:15 telegraf.conf
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ ls -la /home/mastersurface/mosquitto/
total 12
drwxrwxr-x  3 mastersurface mastersurface 4096 Dec 17 16:21 .
drwxr-x--- 30 mastersurface mastersurface 4096 Dec 25 18:18 ..
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 17 16:21 config
[mastersurface@RBL-SurfaceHub:~]$


















**Key Details:**

- InfluxDB Token: `RBL_SuperToken_2024`
- Organization: `RBL_SPHub`
- Bucket: `Mad_Masters/Helpers`
- MQTT Topics: `rbl/+/+` (wildcard pattern - accepts rbl/anything/anything)
- No authentication on MQTT (anonymous allowed)














[mastersurface@RBL-SurfaceHub:~]$ find ~/ -type d -name "*Projects*" -o -name "*DiagTool*" -o -name "*ReBoot*" 2>/dev/null
/home/mastersurface/Pictures/DiagTool Images
/home/mastersurface/Pictures/DiagTool Images/ReBoot Labs Possible Final.PNG
/home/mastersurface/Pictures/SLideshow/ReBoot Labs Possible Final.PNG
/home/mastersurface/Pictures/SLideshow/ReBoot Lab (FinalSkull1).png
/home/mastersurface/Pictures/SLideshow/ReBoot Lab Concepts.png
/home/mastersurface/Pictures/Logo Ideas/ReBoot Labs Possible Final.PNG
/home/mastersurface/Pictures/Logo Ideas/ReBoot Lab (FinalSkull1).png
/home/mastersurface/Pictures/Logo Ideas/ReBoot Lab Concepts.png
/home/mastersurface/Pictures/RBLMasterTOOL Slideshow (480x320)/ReBoot Labs Possible Final.PNG
/home/mastersurface/.local/share/backgrounds/2025-12-16-23-43-03-ReBoot Labs Possible Final.PNG
/home/mastersurface/Projects
/home/mastersurface/Projects/DiagTool1
/home/mastersurface/ReBoot_Labs
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ ls -la ~/Documents/
total 8
drwxr-xr-x  2 mastersurface mastersurface 4096 Dec 16 09:58 .
drwxr-x--- 30 mastersurface mastersurface 4096 Dec 25 18:18 ..
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ ls -la ~/Desktop/
total 8
drwxr-xr-x  2 mastersurface mastersurface 4096 Dec 23 21:42 .
drwxr-x--- 30 mastersurface mastersurface 4096 Dec 25 18:18 ..
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ find ~/ -maxdepth 3 -type f \( -name "*.py" -o -name "*.sh" -o -name "*.md" \) 2>/dev/null | grep -v ".vscode" | grep -v "snap"
/home/mastersurface/check_services.sh
/home/mastersurface/bin/rebootlab-header.sh
/home/mastersurface/Projects/HomeLabDocs/Mad_SPHub_Config.md
/home/mastersurface/Projects/HomeLabDocs/Pi_Inventory.md
/home/mastersurface/Projects/Docs/camera_plan.md
/home/mastersurface/.bashrc.d/rebootlab.sh
[mastersurface@RBL-SurfaceHub:~]$


















[mastersurface@RBL-SurfaceHub:~]$ ls -la ~/Projects/DiagTool1/
total 8
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 25 21:01 .
drwxrwxr-x 10 mastersurface mastersurface 4096 Dec 25 21:01 ..
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ ls -la ~/ReBoot_Labs/
total 40
drwxrwxr-x 10 mastersurface mastersurface 4096 Dec 22 13:42 .
drwxr-x--- 30 mastersurface mastersurface 4096 Dec 25 18:18 ..
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 22 13:42 backups
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 22 13:42 configs
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 22 13:42 logs
drwxrwxr-x  4 mastersurface mastersurface 4096 Dec 22 13:42 monitoring
drwxrwxr-x  5 mastersurface mastersurface 4096 Dec 22 13:42 pi_cluster
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 22 13:42 reports
drwxrwxr-x  2 mastersurface mastersurface 4096 Dec 22 13:42 scripts
drwxrwxr-x  5 mastersurface mastersurface 4096 Dec 22 13:42 security
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ cat ~/check_services.sh
#!/bin/bash
echo "=== RBL-SurfaceHub Health Check ==="
echo ""
echo "Docker Containers:"
docker ps --format "  {{.Names}}: {{.Status}}"
echo ""
echo "Quick Tests:"
curl -s -o /dev/null -w "  InfluxDB: %{http_code}\n" http://localhost:8086/ping
curl -s -o /dev/null -w "  Grafana:  %{http_code}\n" http://localhost:3000/api/health
nc -zv localhost 1883 2>&1 | grep -q succeeded && echo "  MQTT:     OK" || echo "  MQTT:     FAIL"
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ cat ~/.bashrc.d/rebootlab.sh
clear
~/bin/rebootlab-header.sh
[mastersurface@RBL-SurfaceHub:~]$


[mastersurface@RBL-SurfaceHub:~]$ cat ~/bin/rebootlab-header.sh
#!/bin/bash
# ReBoot Labs Terminal Header

GREEN='\033[0;32m'
BLUE='\033[0;34m'
WHITE='\033[1;37m'
RED='\033[0;31m'
NC='\033[0m' # No Color

echo -e "${GREEN}      ______${NC}"
echo -e "${BLUE}   .-        -.${NC}"
echo -e "${BLUE} //            \\\\${NC}"
echo -e "${BLUE} |,  .-.  .-.  ,|${NC}"
echo -e "${BLUE} |)(_o//  \\\\o_)(|${NC}"
echo -e "${BLUE}  |//   /\\   \\\\|${NC}"
echo -e "${BLUE} (_     ^^     _)${NC}"
echo -e "${WHITE}  \\__|IIIIII|__/${NC}"
echo -e "${WHITE}   | \\IIIIII/ |${NC}"
echo -e "${GREEN}    \\        /${NC}"
echo -e "${GREEN}     --------${NC}"
echo -e "${RED}=== ]:< *Mad_Lab_Work_Time* >:[ ===${NC}"
[mastersurface@RBL-SurfaceHub:~]$













PS C:\Users\Nameless> cat "C:\Users\Nameless\ReBoot Lab Tools&Scripts\Mad_SPHub_Project_Complete.md"
# Mad_SPHub Diagnostic Pipeline - Project Complete

**Date:** December 17, 2025
**Status:** ✅ COMPLETE

---

## System Architecture

```
┌─────────────────┐     MQTT      ┌─────────────────────────────────────┐
│ MasterTOOL      │──────────────▶│          Mad_SPHub (Surface)        │
│ DiagTool0       │               │                                     │
│ (Raspberry Pi)  │               │  ┌───────────┐    ┌──────────────┐  │
└─────────────────┘               │  │ Mosquitto │───▶│   Telegraf   │  │
                                  │  │  (MQTT)   │    │              │  │
┌─────────────────┐               │  └───────────┘    └──────┬───────┘  │
│ MasterHelper    │──────────────▶│                          │          │
│ (Raspberry Pi)  │               │                          ▼          │
└─────────────────┘               │                   ┌──────────────┐  │
                                  │                   │   InfluxDB   │  │
                                  │                   │   (Database) │  │
                                  │                   └──────┬───────┘  │
                                  │                          │          │
                                  │                          ▼          │
                                  │                   ┌──────────────┐  │
                                  │                   │   Grafana    │  │
                                  │                   │  (Dashboard) │  │
                                  │                   └──────────────┘  │
                                  └─────────────────────────────────────┘
```

---

## Hostnames (Zero IP Policy)

| Device | Hostname | Role |
|--------|----------|------|
| Surface Pro 3 | RBL-SurfaceHub | Hub/Server |
| Raspberry Pi | MasterTOOL-DiagTool0 | Diagnostic Node |
| Raspberry Pi | MasterHelper | Diagnostic Node |

---

## Docker Containers on Mad_SPHub

| Container | Port | Purpose |
|-----------|------|---------|
| influxdb | 8086 | Time-series database |
| grafana | 3000 | Dashboard visualization |
| telegraf | - | MQTT → InfluxDB pipeline |
| mosquitto | 1883 | MQTT broker |
| portainer | 9000/9443 | Container management |

---

## InfluxDB Configuration

- **Organization:** RBL_SPHub
- **Bucket:** Mad_Masters/Helpers
- **Token:** `iMdFFwa1INU555QXnSGtWjay74bpEqHPHA7fB5dDWr6prRlIA9fuA_N5zFAems8lDdPcUkw-d_-7twV31R5d6A==`

---

## Telegraf Config

**Location:** `/home/mastersurface/telegraf/telegraf.conf`

```toml
[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1000
  metric_buffer_limit = 10000
  flush_interval = "10s"

[[outputs.influxdb_v2]]
  urls = ["http://172.17.0.1:8086"]
  token = "iMdFFwa1INU555QXnSGtWjay74bpEqHPHA7fB5dDWr6prRlIA9fuA_N5zFAems8lDdPcUkw-d_-7twV31R5d6A=="
  organization = "RBL_SPHub"
  bucket = "Mad_Masters/Helpers"

[[inputs.mqtt_consumer]]
  servers = ["tcp://172.17.0.1:1883"]
  topics = ["rbl/+/+"]
  qos = 0
  client_id = "telegraf-hub"
  data_format = "json"
  topic_tag = "topic"
  json_string_fields = ["status"]
```

---

## Mosquitto Config

**Location:** `/home/mastersurface/mosquitto/config/mosquitto.conf`

```
listener 1883
allow_anonymous true
```

---

## Pi Diagnostic Script

**Location on each Pi:** `/home/rebootlabs/diag_publisher.py`

**Service:** `diag-publisher.service`

**Metrics Published:**
| Field | Description | Unit |
|-------|-------------|------|
| temp | CPU Temperature | °C |
| freq | CPU Frequency | MHz |
| cpu_pct | CPU Usage | % |
| mem_used | Memory Used | MB |
| mem_total | Memory Total | MB |
| mem_pct | Memory Usage | % |
| swap | Swap Used | MB |
| disk_used | Disk Used | GB |
| disk_total | Disk Total | GB |
| disk_pct | Disk Usage | % |
| uptime_hrs | Uptime | hours |
| throttle | Throttle Status | 0=OK |
| voltage | Core Voltage | V |

**MQTT Topics:**
- MasterTOOL: `rbl/sensors/diag`
- MasterHelper: `rbl/sensors/helper`

---

## Service Management

**On Pis:**
```bash
# Check status
sudo systemctl status diag-publisher

# Restart
sudo systemctl restart diag-publisher

# View logs
sudo journalctl -u diag-publisher -n 20
```

**On Mad_SPHub:**
```bash
# Check all containers
docker ps

# Restart a container
docker restart telegraf

# View container logs
docker logs telegraf --tail 50
```

---

## Grafana Access

**URL:** `http://localhost:3000` (on Surface)

**Kiosk Mode:**
```bash
firefox --kiosk "http://localhost:3000/d/DASHBOARD_ID"
```

**Flux Query Template:**
```flux
from(bucket: "Mad_Masters/Helpers")
  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)
  |> filter(fn: (r) => r._measurement == "mqtt_consumer")
  |> filter(fn: (r) => r.topic == "rbl/sensors/diag")
  |> last()
```

---

## Hosts File Entries (on Pis)

```
192.168.1.188 RBL-SurfaceHub RBL-SurfaceHub.home.local Mad_SPHub
```

---

## Troubleshooting

**Telegraf crashing:**
```bash
docker logs telegraf --tail 50
```

**No data in Grafana:**
1. Check time range (Last 15 minutes)
2. Verify Pi service: `sudo systemctl status diag-publisher`
3. Test MQTT: `docker exec mosquitto mosquitto_pub -t rbl/test/temp -m '{"temp": 42.5}'`

**Query InfluxDB directly:**
```bash
docker exec influxdb influx query --org RBL_SPHub --token "TOKEN" 'from(bucket: "Mad_Masters/Helpers") |> range(start: -5m) |> limit(n: 10)'
```

---

## Project Identity

- **Project:** ReBoot Labs (RBL)
- **Hub Hostname:** RBL-SurfaceHub
- **Organization:** RBL_SPHub
- **Bucket:** Mad_Masters/Helpers

---

**Completed:** December 17, 2025

*"I can do all things through Christ who strengthens me." - Philippians 4:13 NKJV*
PS C:\Users\Nameless>